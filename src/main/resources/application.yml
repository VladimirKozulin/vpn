server:
  port: 8080
  ssl:
    enabled: true
    key-store: classpath:ssl/keystore.p12
    key-store-password: changeit
    key-store-type: PKCS12
    key-alias: vpn-server

spring:
  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:vpn_db}
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:postgres}
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: false
        use_sql_comments: false
        jdbc:
          lob:
            non_contextual_creation: true
  sql:
    init:
      mode: always
      platform: postgresql
  task:
    scheduling:
      pool:
        size: 5
  
  # OAuth2 + Keycloak –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
  security:
    oauth2:
      client:
        registration:
          keycloak:
            client-id: ${KEYCLOAK_CLIENT_ID:vpn-client}
            client-secret: ${KEYCLOAK_CLIENT_SECRET}
            scope: openid,profile,email
            authorization-grant-type: authorization_code
            redirect-uri: "{baseUrl}/login/oauth2/code/{registrationId}"
        provider:
          keycloak:
            # –î–ª—è –±—Ä–∞—É–∑–µ—Ä–∞ (–≤–Ω–µ—à–Ω–∏–π URL)
            authorization-uri: http://localhost:8180/realms/${KEYCLOAK_REALM:vpn}/protocol/openid-connect/auth
            # –î–ª—è Spring Boot (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π Docker URL)
            token-uri: http://keycloak:8080/realms/${KEYCLOAK_REALM:vpn}/protocol/openid-connect/token
            # –û—Ç–∫–ª—é—á–∞–µ–º userinfo - –±—É–¥–µ–º –±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ JWT
            # user-info-uri: http://keycloak:8080/realms/${KEYCLOAK_REALM:vpn}/protocol/openid-connect/userinfo
            jwk-set-uri: http://keycloak:8080/realms/${KEYCLOAK_REALM:vpn}/protocol/openid-connect/certs
            user-name-attribute: preferred_username
      resourceserver:
        jwt:
          # –î–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ JWT (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π Docker URL)
          issuer-uri: http://keycloak:8080/realms/${KEYCLOAK_REALM:vpn}

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ VPN —Å–µ—Ä–≤–µ—Ä–∞
vpn:
  xray-path: ${VPN_XRAY_PATH}
  xray-port: ${VPN_XRAY_PORT}
  server-address: ${VPN_SERVER_ADDRESS}
  config-path: ${VPN_CONFIG_PATH}
  api-server: ${VPN_API_SERVER:127.0.0.1:10085}
  inbound-tag: ${VPN_INBOUND_TAG:inbound-443}
  

  reality:
    enabled: ${VPN_REALITY_ENABLED}
    dest: ${VPN_REALITY_DEST:www.microsoft.com}
    server-names:
      - www.microsoft.com
    private-key: ${VPN_REALITY_PRIVATE_KEY}
    public-key: ${VPN_REALITY_PUBLIC_KEY}
    short-ids:
      - ""
      - "6ba85179e30d4fc2"
    fingerprint: ${VPN_REALITY_FINGERPRINT}

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
logging:
  level:
    com.example.vpn: DEBUG
    org.hibernate: WARN  # –£–±–∏—Ä–∞–µ–º –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ Hibernate
    org.springframework.web: INFO  # –£–±–∏—Ä–∞–µ–º DEBUG –ª–æ–≥–∏ Spring Web
    org.springframework.boot: INFO  # –£–±–∏—Ä–∞–µ–º DEBUG –ª–æ–≥–∏ Spring Boot
    org.springframework.security: DEBUG  # –í–∫–ª—é—á–∞–µ–º –ª–æ–≥–∏ Security –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
  pattern:
    console: "%d{dd.MM HH:mm:ss} %clr(%-5level) %clr(%logger{20}){cyan} : %msg%n"
    # –§–æ—Ä–º–∞—Ç: 07.02 09:51:09 INFO  HomeController : üîó –ì–µ–Ω–µ—Ä–∞—Ü–∏—è VLESS —Å—Å—ã–ª–∫–∏...
